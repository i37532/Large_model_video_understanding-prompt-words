### docker命令：

```
docker restart 464
docker exec -it 464 /bin/bash
conda activate py310
cd /qw/qwen-vl/pic_project/
python main.py
```

第一步:进入容器 

```
docker exec -it 464 /bin/bash
```

第二步:切换conda环境:

```
conda activate py310
```

第三部:进入

```
cd /qw/qwen-vl/pic_project/
python main.py
```

前端界面:http://192.168.110.87:7666/
项目路径:/data/lihui/qw/qwen-vl
```
给定用户的两个输入，
用户输入1：视频背景描述，对应提示词中的item.background
用户输入2：要识别的事件，对应提示词中的event
请你重新帮我修改提示词，使得最后输出的描述简单（不超过30个字），同时描述清晰具体，满足像例子一样的效果：

例子1：
用户输入1:机器人整理家务
用户输入2：整理家务

预期输出描述：（希望按照机器人把xxx放在了xxx地方这样的句式回答）
03:机器人抓取了一件衣服放在了黄色的沙发上
17:机器人抓取了一个易拉罐放在了蓝色的垃圾桶里
20:机器人抓取了一个香蕉放在了黑色垃圾桶里

例子2：
用户输入1:小孩监控
用户输入2：小孩危险事件

预期输出描述：（希望描述小孩具体存在哪些危险）
00:36: 小孩躺在地上，有可能存在跌倒或者抽搐等危险
07:36:小孩站在椅子上，有可能存在跌落等危险
```
- 视频理解那个任务的原则是，-宁愿漏掉识别到的东西，也不要识别错

- 阈值可以调高过滤
- 结果可以少，但是要准

提示词如下：

```python
 messages = [
                {
                    "role": "system",
                    # ----------------------------------------------------------------------------------
                    "content": """根据用户的输入提示词,通过当前图片的背景来源,你需要仔细分析这张图片\
                               并且以json格式输出,一张图片可能存在多个事件,请你按照指定格式输出.
                               [{"event": // 事件名称
                                "explain": //事件说明,给出详细理由
                                "match": //符合程度,范围0~1.0,0代表不符合,0.5代表可能符合,1代表符合}]""",
                },
                {
                    "role": "user",
                    "content": [
                        {"type": "image",
                         "image": "./" + output_dir + "/" + url},
                        {
                            "type": "text",
                   # -------------------------------------------------------------------------------------
                            "text": f"背景来源:{item.background},请你仔细分析,是否存在{str(event)}"
                        }
                    ]
                }
            ]
```
### 2.0
```
messages = [
                {
                    "role": "system",
                    # ----------------------------------------------------------------------------------
                    "content": """
                    你需要判断画面中是否存在用户指定的事件，并提供具体的发生过程要素。
                    必须基于画面中真实可见的主体、动作、涉及的物品或位置，严禁仅依据文字描述或示意图脑补推理。

                    通用要求：
                    1 画面中必须可见执行主体（如人、儿童、宠物、机器人、机械臂），并描述其外形或位置；
                    2 必须有清晰可见的动作过程（如抓取、搬运、放置、投掷、攀爬、骑行等）；
                    3 必须有具体的物品或目标位置（如垃圾桶、沙发、茶几、栏杆）；

                    请输出 JSON 格式，每条事件必须包含：
                    [{
                     "event": 事件名称（与用户输入一致）
                     "subject": 主体（如“机器人”）
                     "action": 动作（如“抓取”“放置”“骑自行车”）
                     "object": 被操作的物品或位置（如“衣物”“蓝色垃圾桶”“茶几”）
                     "target_location": 若适用，动作的目标位置（如“放在蓝色垃圾桶”“放在沙发上”）；若为危险行为，可为空
                     "explain": 用主谓宾+因果清楚描述整个过程（如“机器人抓取了一件衣物放在了黄色沙发上”）
                     "match": 0~1.0（若缺少任何要素或无法在画面中看见，match = 0，并在 explain 中说明缺少什么）
                    }]
                    示例：
                    [{
                        "event": "整理家务",
                        "subject": "机器人",
                        "action": "抓取",
                        "object": "衣物",
                        "target_location": "黄色沙发",
                        "explain": "机器人抓取了一件衣物放在了黄色沙发上",
                        "match": 1.0
                    }]

                    若画面仅包含文字、流程框、示意图或结果，而未出现真实主体或动作过程，须输出 match = 0。
                    """,
                },
                {
                    "role": "user",
                    "content": [
                        {"type": "image",
                         "image": "./" + output_dir + "/" + url},
                        {
                            "type": "text",
                            # -------------------------------------------------------------------------------------
                            "text": f"背景来源:{item.background},\
                            请严格判断是否真实存在用户指定的事件“{str(event)}”，\
                            必须基于画面中可见的真实物体、人物或动作来判定，\
                            不得仅依据文字、标签、流程示意图或抽象概念推断。\
                            必须基于画面中真实可见的主体、动作过程、物品或位置，不得仅依据文字或示意图推断。"
                        }
                    ]
                }
            ]
```